<!-- <ion-header>
  <ion-toolbar>
    <ion-title></ion-title>
  </ion-toolbar>
</ion-header> -->

<ion-content>

    <div class="topInfo">
        <ion-progress-bar [value]="width"></ion-progress-bar>

        <ion-item lines="none" class="bg-none">
            <ion-avatar slot="start">
                <img src="./assets/imgs/user3.png">
            </ion-avatar>
            <ion-label>
                <h5 class="white" *ngIf="stories[tapped].uid==uid">Your Story</h5>
                <h5 class="white" *ngIf="stories[tapped].uid!=uid">{{service.usersData[stories[tapped].uid].fullName}}</h5>
                <p class="gray">8h</p>
            </ion-label>
            <ion-icon (click)="closeStoryViewer()" routerDirection="back" name="close" slot="end" color="lighter"></ion-icon>
        </ion-item>
    </div>
    <video class="storyImg" autoplay muted loop preload="auto">
        <source [src]="stories[tapped].url" type="video/mp4">
    </video>

    <ion-item (click)="showViewers=true" lines="none" class="bg-none bottomViews">
        <img [src]="allUsers[0].profileUrl" slot="start">
        <img [src]="allUsers[1].profileUrl" slot="start" class="overlayImg">
        <ion-label>
            <p class="white">{{allUsers.length}} Viewers</p>
        </ion-label>
        <ion-icon name="ellipsis-vertical" slot="end" color="lighter"></ion-icon>
    </ion-item>

</ion-content>

<!-- <ion-content (press)="pauseStory()" (pressup)="playStory()" (panstart)="pauseStory()" (panend)="playStory()" swipe-vertical (onSwipeUp)="onSwipeUp()" (onSwipeDown)="closeStoryViewer()">
    <ion-slides (ionSlideDidChange)="setStorySeen()" #slides>
        <ion-slide *ngFor="let story of stories; let indexStory = index" [ngClass]="isPaused || isLoading(indexStory) || isWaiting ? 'isPaused' : ''" (tap)="changeStoryItem($event, story)">
            <ion-grid class="pagination">
                <ion-row>
                    <ion-col *ngFor="let items of story.items; let index = index">
                        <div class="seen" [hidden]="index >= story.currentItem"></div>
                        <div #progress class="progress" *ngIf="story.currentItem === index && slides.getActiveIndex() === indexStory" [ngStyle]="{'animation-duration': story.items[story.currentItem].duration + 's'}"></div>
                    </ion-col>
                </ion-row>
            </ion-grid>

            <div class="header" padding>
                <div>
                    <img [src]="story.userPicture" [alt]="'Story de' + story.userName">

                    <div class="info" text-left>
                        <span>{{ story.userName }}</span>
                        <span>{{ story.items[story.currentItem].date }}</span>
                    </div>
                </div>

                <div>
                    <ion-button slot="icon-only" (tap)="closeStoryViewer()">
                        <ion-icon name="close"></ion-icon>
                    </ion-button>
                </div>
            </div>

            <div class="footer">
                <ion-grid>
                    <ion-row>
                        <ion-col class="ion-text-left">
                            <ion-button *ngIf="story.userId === userId">
                                <ion-icon name="eye"></ion-icon> {{ story.items[story.currentItem].views }}
                            </ion-button>
                        </ion-col>

                        <ion-col size="8" *ngIf="story.userId != userId">
                            <ion-item no-lines>
                                <ion-input type="text" placeholder="Responder story" (ionFocus)="pauseStory()" (ionBlur)="playStory()"></ion-input>
                            </ion-item>
                        </ion-col>

                        <ion-col class="ion-text-right">
                            <ion-button class="ion-icon-right" *ngIf="story.userId === userId">
                                <ion-icon name="more"></ion-icon>
                            </ion-button>
                        </ion-col>
                    </ion-row>
                </ion-grid>
            </div>

            <div class="item" *ngFor="let item of story.items; let index = index" [hidden]="story.currentItem != index">
                <ion-spinner [hidden]="item.type == 0 || (!isLoading(indexStory) && !isWaiting)"></ion-spinner>

                <img [src]="item.media" [alt]="'Story de' + story.userName" [hidden]="item.type != 0">

                <video #video webkit-playsinline playsinline preload="metadata" [src]="item.media" *ngIf="item.type == 1 && story.currentItem === index "></video>
            </div>
        </ion-slide>
    </ion-slides>
</ion-content> -->


<div (click)="closeModal($event)" id="mainContainer" *ngIf="showViewers" class="viewerSheet">
    <div class="innerContent bg-white ion-padding">
        <ion-item lines="none" class="ion-no-padding">
            <ion-label>
                <p class="dark">{{allUsers.length}} Viewers</p>
            </ion-label>
            <ion-icon name="close" slot="end" (click)="showViewers=false"></ion-icon>
        </ion-item>
        <ion-row class="borderBottom">
            <ion-col size="4">
                <img class="boxshadow" src="./assets/imgs/Video BG.png">
            </ion-col>
            <ion-col size="4">
                <div class="addStory">
                    <ion-fab style="margin-top: -2.2em;" vertical="center" horizontal="center">
                        <ion-fab-button size="small">
                            <ion-icon name="add"></ion-icon>
                        </ion-fab-button>
                    </ion-fab>
                </div>
            </ion-col>
        </ion-row>
        <div class="scrollingContent">
            <ion-item *ngFor="let user of allUsers" lines="none">
                <ion-avatar slot="start">
                    <span class="onlineIcon"></span>
                    <img [src]="user.profileUrl">
                </ion-avatar>
                <ion-label>
                    <h5>Angelina Julie</h5>
                    <p class="gray">nathanwilson</p>
                </ion-label>
                <ion-icon name="ellipsis-vertical" slot="end" color="medium"></ion-icon>
            </ion-item>
        </div>
    </div>
</div>